<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Details - GuildCertified</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="index.html" style="text-decoration: none; color: inherit;">
                    <h1><i class="fab fa-discord"></i> GuildCertified</h1>
                </a>
            </div>
            <nav class="nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="index.html#servers" class="nav-link">Browse Servers</a>
                <div class="nav-auth" id="nav-auth-logged-out">
                    <button id="login-btn" class="btn btn-outline">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                </div>
                <div class="nav-auth" id="nav-auth-logged-in" style="display: none;">
                    <a href="dashboard.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                    <div class="user-menu">
                        <img id="user-avatar" class="user-avatar" src="" alt="User Avatar">
                        <span id="user-name">User</span>
                        <div class="dropdown-menu">
                            <a href="profile.html">My Profile</a>
                            <a href="#" id="setup-server-btn"><i class="fas fa-server"></i> Set Server Up</a>
                            <a href="#settings">Settings</a>
                            <a href="#" id="logout-btn">Logout</a>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Loading State -->
    <div id="server-loading" class="loading-container">
        <div class="loading-spinner"></div>
        <h2>Loading Server Details...</h2>
        <p>Please wait while we fetch the server information.</p>
    </div>

    <!-- Error State -->
    <div id="server-not-found" class="error-container" style="display: none;">
        <div class="error-content">
            <i class="fas fa-exclamation-triangle"></i>
            <h2>Server Not Found</h2>
            <p>The server you're looking for doesn't exist or may have been removed.</p>
            <a href="index.html" class="btn btn-primary">
                <i class="fas fa-home"></i> Back to Home
            </a>
        </div>
    </div>

    <!-- Server Details Content -->
    <main id="server-content" style="display: none;">
        <!-- Server Header -->
        <section class="server-header-section">
            <div class="container">
                <div class="server-header-content">
                    <div class="server-header-main">
                        <div class="server-icon-container">
                            <img id="server-icon" class="server-icon" src="" alt="Server Icon">
                        </div>
                        <div class="server-info">
                            <div class="server-title">
                                <h1 id="server-name">Server Name</h1>
                                <span id="server-category" class="server-category">Category</span>
                            </div>
                            <div class="server-meta">
                                <div class="meta-item">
                                    <i class="fas fa-user"></i>
                                    <span>Owner: <strong id="server-owner">Unknown</strong></span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-calendar"></i>
                                    <span>Created: <span id="server-created">Unknown</span></span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-users"></i>
                                    <span id="server-members">0 members</span>
                                </div>
                            </div>
                            <div class="server-rating">
                                <div class="rating-display">
                                    <div id="server-stars" class="stars"></div>
                                    <span id="server-rating-text" class="rating-text">0.0 (0 reviews)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="server-actions">
                        <a id="join-server-btn" class="btn btn-primary btn-large" href="#" target="_blank">
                            <i class="fab fa-discord"></i> Join Server
                        </a>
                        <button id="write-review-btn" class="btn btn-outline">
                            <i class="fas fa-star"></i> Write Review
                        </button>
                        <button id="share-server-btn" class="btn btn-outline">
                            <i class="fas fa-share"></i> Share
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Server Content Grid -->
        <section class="server-content-section">
            <div class="container">
                <div class="server-content-grid">
                    
                    <!-- Main Content Column -->
                    <div class="server-main-content">
                        
                        <!-- Description -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3><i class="fas fa-info-circle"></i> About This Server</h3>
                            </div>
                            <div class="server-description-content">
                                <p id="server-description">Server description will be loaded here...</p>
                                
                                <div id="server-tags-container" class="server-tags">
                                    <!-- Tags will be loaded here -->
                                </div>
                                
                                <div id="server-rules-container" class="server-rules" style="display: none;">
                                    <h4><i class="fas fa-gavel"></i> Server Rules</h4>
                                    <div id="server-rules-content"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Reviews Section -->
                        <div class="content-card">
                            <div class="card-header">
                                <h3><i class="fas fa-star"></i> Reviews</h3>
                                <div class="card-header-actions">
                                    <select id="review-sort" class="form-control">
                                        <option value="newest">Newest First</option>
                                        <option value="oldest">Oldest First</option>
                                        <option value="highest">Highest Rated</option>
                                        <option value="lowest">Lowest Rated</option>
                                    </select>
                                </div>
                            </div>
                            <div id="reviews-container" class="reviews-container">
                                <!-- Reviews will be loaded here -->
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar -->
                    <div class="server-sidebar">
                        
                        <!-- Server Stats -->
                        <div class="sidebar-card">
                            <div class="card-header">
                                <h4><i class="fas fa-chart-bar"></i> Server Statistics</h4>
                            </div>
                            <div class="stats-list">
                                <div class="stat-item">
                                    <span class="stat-label">Total Reviews</span>
                                    <span id="total-reviews-count" class="stat-value">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Average Rating</span>
                                    <span id="avg-rating-value" class="stat-value">0.0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Members</span>
                                    <span id="members-count" class="stat-value">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Status</span>
                                    <span id="server-status" class="stat-value">Active</span>
                                </div>
                            </div>
                        </div>

                        <!-- Rating Breakdown -->
                        <div class="sidebar-card">
                            <div class="card-header">
                                <h4><i class="fas fa-chart-pie"></i> Rating Breakdown</h4>
                            </div>
                            <div class="rating-breakdown">
                                <div class="rating-bar-item">
                                    <span class="rating-label">5 ⭐</span>
                                    <div class="rating-bar">
                                        <div class="rating-fill" id="rating-5-fill" style="inline-size: 0%"></div>
                                    </div>
                                    <span class="rating-count" id="rating-5-count">0</span>
                                </div>
                                <div class="rating-bar-item">
                                    <span class="rating-label">4 ⭐</span>
                                    <div class="rating-bar">
                                        <div class="rating-fill" id="rating-4-fill" style="inline-size: 0%"></div>
                                    </div>
                                    <span class="rating-count" id="rating-4-count">0</span>
                                </div>
                                <div class="rating-bar-item">
                                    <span class="rating-label">3 ⭐</span>
                                    <div class="rating-bar">
                                        <div class="rating-fill" id="rating-3-fill" style="inline-size: 0%"></div>
                                    </div>
                                    <span class="rating-count" id="rating-3-count">0</span>
                                </div>
                                <div class="rating-bar-item">
                                    <span class="rating-label">2 ⭐</span>
                                    <div class="rating-bar">
                                        <div class="rating-fill" id="rating-2-fill" style="inline-size: 0%"></div>
                                    </div>
                                    <span class="rating-count" id="rating-2-count">0</span>
                                </div>
                                <div class="rating-bar-item">
                                    <span class="rating-label">1 ⭐</span>
                                    <div class="rating-bar">
                                        <div class="rating-fill" id="rating-1-fill" style="inline-size: 0%"></div>
                                    </div>
                                    <span class="rating-count" id="rating-1-count">0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Similar Servers -->
                        <div class="sidebar-card">
                            <div class="card-header">
                                <h4><i class="fas fa-search"></i> Similar Servers</h4>
                            </div>
                            <div id="similar-servers-container" class="similar-servers">
                                <!-- Similar servers will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Write Review Modal -->
    <div id="review-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-star"></i> Write a Review</h3>
                <button class="modal-close" onclick="closeReviewModal()">&times;</button>
            </div>
            
            <form id="review-form">
                <div class="form-group">
                    <label for="review-rating">Rating <span style="color: #ef4444;">*</span></label>
                    <div class="star-rating" id="review-star-rating">
                        <i class="fas fa-star" data-rating="1"></i>
                        <i class="fas fa-star" data-rating="2"></i>
                        <i class="fas fa-star" data-rating="3"></i>
                        <i class="fas fa-star" data-rating="4"></i>
                        <i class="fas fa-star" data-rating="5"></i>
                    </div>
                    <input type="hidden" id="review-rating" required>
                </div>
                
                <div class="form-group">
                    <label for="review-text">Your Review <span style="color: #ef4444;">*</span></label>
                    <textarea id="review-text" placeholder="Share your experience with this server..." rows="4" maxlength="1000" required></textarea>
                    <div class="character-count">
                        <span id="review-char-count">0</span> / 1000 characters
                    </div>
                </div>
            </form>
            
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeReviewModal()">Cancel</button>
                <button type="button" id="submit-review-btn" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Submit Review
                </button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="share-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-share"></i> Share Server</h3>
                <button class="modal-close" onclick="closeShareModal()">&times;</button>
            </div>
            
            <div class="share-content">
                <div class="form-group">
                    <label for="share-url">Server URL</label>
                    <div class="url-input-container">
                        <input type="text" id="share-url" readonly>
                        <button class="btn btn-secondary" onclick="copyShareUrl()">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                </div>
                
                <div class="share-buttons">
                    <h4>Share on Social Media</h4>
                    <div class="social-share-buttons">
                        <button class="share-btn twitter-btn" onclick="shareOnTwitter()">
                            <i class="fab fa-twitter"></i> Twitter
                        </button>
                        <button class="share-btn facebook-btn" onclick="shareOnFacebook()">
                            <i class="fab fa-facebook"></i> Facebook
                        </button>
                        <button class="share-btn discord-btn" onclick="shareOnDiscord()">
                            <i class="fab fa-discord"></i> Discord
                        </button>
                        <button class="share-btn reddit-btn" onclick="shareOnReddit()">
                            <i class="fab fa-reddit"></i> Reddit
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="text/javascript" src="js/logger.js"></script>
    <script type="text/javascript" src="js/config.js"></script>
    <script type="module" src="js/auth-discord.js"></script>
    <script type="text/javascript" src="js/localDataManager.js"></script>
    <script type="module" src="js/serverDetails.js"></script>
</body>
</html>